
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Webmap della gara">
  <meta name="author" content="Luca Moiana">
  <link rel="icon" href="../../favicon.ico">

  <title>VI maratonina del RUGARETO</title>

  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/rugareto.css">

  <style type="text/css">

  html {
    height: 100%;
    width: 100%;
    overflow: hidden;
  }
  body {
    height: 100%;
    width: 100%;
    padding-top: 50px;
    padding-bottom: 0px;
  }
  #map {
    height: 100%;
    width: 100%;
  }

  /* Custom page CSS
  -------------------------------------------------- */
  /* Not required for template or sticky footer method. */
  .container .text-muted {
    margin: 00px 0;
  }

  code {
    font-size: 80%;
  }
.dist-marker {
font-size: 14px;
text-align: center;
color: #425025;
text-shadow: 1.5px 0 0 #FFFFFF, -1.5px 0 0 #FFFFFF, 0 1.5px 0 #FFFFFF, 0 -1.5px 0 #FFFFFF, 0.75px 0.75px #FFFFFF, -0.75px -0.75px 0 #FFFFFF, 0.75px -0.75px 0 #FFFFFF, -0.75px 0.75px 0 #FFFFFF; }
.weather {
font: 8px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
box-shadow: 0 1px 5px rgba(0,0,0,0.4);
width:auto;
padding: 5px 10px 5px 10px;
text-color: #425025;
text-decoration:none;
background: #A7B65B;
margin-right: 10px;
margin-top: 5px;
border-radius: 5px;
}

  /* Custom page CSS
  -------------------------------------------------- */
  /* Not required for template or sticky footer method. */
  .container .text-muted {
    margin: 20px 0;
  }
  code {
    font-size: 80%;
  }

</style>
</head>

<body>

  <!-- Fixed navbar -->
  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="VI_MDR_index.html">
          MdR 2015
          </a>
      </div>
      <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="MdR2015_regolamento.html"><i class="fa fa-clipboard"></i>&nbsp;&nbsp;Regolamento</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-pencil"></i>&nbsp;Iscrizioni</a>
            <ul class="dropdown-menu" role="menu">
              <li><a href="./DATA/IscrizioneMinori.pdf"><i class="fa fa-user"></i>&nbsp;Modulo iscrizione minori NON accompagnati</a></li>
            </ul>
          </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-heart"></i>&nbsp;Solidariet&#224</a>
        <ul class="dropdown-menu" role="menu">
          <li><a href="http://www.associazioneagres.com/">Parte del ricavato<br> verr√† devoluto a A.G.R.E.S.</a></li>
        </ul>
      </li>

		<li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-envelope"></i>&nbsp;Contatti</a>
            <ul class="dropdown-menu" role="menu">
              <li><a href="mailto:info@5cascine.it?subject=Richiesta%20informazioni%20Maratonina%20del%20Rugareto%202015"><i class="fa fa-envelope"></i>&nbsp;email</a></li>
              <li><a href="https://www.facebook.com/MaratoninaDelRugareto/"><i class="fa fa-facebook"></i>&nbsp;Facebook</a></li>
			  <li><a href="https://twitter.com/5cascine"><i class=" fa fa-twitter"></i>&nbsp;Twitter</a></li>
			  <li><a href="https://instagram.com/5cascine/"><i class="fa fa-instagram"></i>&nbsp;Instagram</a></li>
            </ul>
          </li>
		  <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-bookmark"></i>&nbsp;Sponsor</a>
            <ul class="dropdown-menu" role="menu">
            <li role="presentation" class="dropdown-header"> Sponsor ufficiali 5 Cascine</li>
              <li><a href="http://www.campingcontinental.com"> Continental Camping Village</a></li>
			  <li><a href="http://www.facebook.com/ilgelatosaronno"> Il Gelato</a></li>
			  <li><a href="http://www.acpmi.it"> AC Consulting di Saronno</a></li>
			  <li class="divider"></li>
			  <li role="presentation" class="dropdown-header">Sponsor Maratonina 2015</li>
        <li><a href="http://www.More Transport">Allianz Ras Agenzia Di Mozzate</a></li>
			  <li><a href="http://www.visiolingue.com">Vision Lingue</a></li>
				<li><a href="http://www.moretransport.it">More Transport</a></li>
        <li><a href="http://www.fisio1.it">Centro Medico Sportivio Fisio 1</a></li>
        <li><a href="http://www.carlabbigliamento.com">Carlabbigliamento Emporium</a></li>
        <li><a href="#">Azienda Agricola La Vigna</a></li>
        <li><a href="#">Cartolibreria La Mimosa</a></li>
        <li><a href="#">L'oasi - Frutta e verdura</a></li>
            </ul>
          </li>

          <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-cloud-download"></i>&nbsp;Download</a>
                <ul class="dropdown-menu" role="menu">
                  <li><a href="./DATA/corto.gpx"> 7Km GPX</a></li>
            <li><a href="./DATA/medio.gpx"> 15Km GPX</a></li>
            <li><a href="./DATA/lungo.gpx"> 20Km GPX</a></li>
                </ul>
              </li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </nav>

  <!-- Begin page content -->
  <div id="map">
    map
  </div>




  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.js'></script>

  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>

  <link rel="stylesheet" href="css/leaflet.awesome-markers.css">

  <script src="src/leaflet.awesome-markers.js"></script>

  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
  <script src='https://code.jquery.com/jquery-1.11.0.min.js'></script>
  <script src="src/leaflet.groupedlayercontrol.js"></script>
  <link rel="stylesheet" href="css/leaflet.groupedlayercontrol.css" />
  <script src="src/leaflet.geometryutil.js" type="text/javascript"></script>
  <script src="src/leaflet-distance-marker.js" type="text/javascript"></script>
  <link rel="stylesheet" href="css/leaflet.zoomhome.css"/>
  <script src="src/leaflet.zoomhome.min.js"></script>
  <script src="src/Leaflet.MakiMarkers.js"></script>
  <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> -->
  <!-- Dati -->
  <script src="DATA/parking.js"> </script>
  <script src="DATA/corto.js"> </script>
  <script src="DATA/medio.js"> </script>
  <script src="DATA/lungo.js"> </script>
  <script type="text/javascript">
  // Mapbox access
  L.mapbox.accessToken = 'pk.eyJ1IjoibHVjYW1vaWFuYSIsImEiOiJfeUttT1pzIn0.7_LM4jNrpSFn7a9f6QqiYA';
  // Mapbox Outdoor
  var mapboxTilesOutdoor = L.tileLayer('https://{s}.tiles.mapbox.com/v3/lucamoiana.lbpoe5b6/{z}/{x}/{y}.png', {
  attribution: '<a href="http://www.mapbox.com/about/maps/" target="_blank">Terms &amp; Feedback</a>',
  minZoom: 13,
  maxZoom: 18,
  continuousWorld: false
  });
  // Map
  var map = L.map('map', {zoomControl: false})
  .addLayer(mapboxTilesOutdoor)
  .setView([45.642, 8.954], 14);
  // Add control and zoom home
  var zoomHome = L.Control.zoomHome({position: 'topleft'});
  zoomHome.addTo(map);
  // Create a layer group
  var servizi = new L.LayerGroup();
  // Aggiunti marker
  // Creare icone
  var partenza_icon = L.MakiMarkers.icon({icon: "pitch", color: "#EA3556", size: "m"});
  var ristoro_icon = L.MakiMarkers.icon({icon: "beer", color: "#55BBEE", size: "m"});
  var stazione_icon = L.MakiMarkers.icon({icon: "rail", color: "#ab89ab", size: "m"});
  var parcheggio_icon = L.MakiMarkers.icon({icon: "parking", color: "4444BB", size: "m"});
  //Creati markers
  var partenza = L.marker([45.656945208740474, 8.970540960046485], {icon: partenza_icon}).bindPopup("<strong>PARTENZA</strong></br>Villa Isacchi</br>dalla 8:00 alle 9:00").addTo(map);
  var ristoro_smaria_corto = L.marker([45.651081575394848, 8.968399155811024], {icon: ristoro_icon}).bindPopup("<img width=210 height=131 src=img/smaria.jpg /><strong><br />Ristoro S. Maria</strong>");
  var ristoro_massina_corto = L.marker([45.6398993999927, 8.9654026], {icon: ristoro_icon}).bindPopup("<strong>Ristoro Massina</strong>");
  var ristoro_smaria_medio = L.marker([45.651081575394848, 8.968399155811024], {icon: ristoro_icon}).bindPopup("<img width=210 height=131 src=img/smaria.jpg /><strong><br />Ristoro S. Maria</strong>");
  var ristoro_massina_medio = L.marker([45.6398993999927, 8.9654026], {icon: ristoro_icon}).bindPopup("<strong>Ristoro Massina</strong>");
  var ristoro_roccolo_medio = L.marker([45.641661216226915, 8.953651498531297], {icon: ristoro_icon}).bindPopup("<img width=210 height=131 src=img/roccolo.jpg><strong><br />Risotoro il Roccolo</strong>");
  var ristoro_visconta_medio = L.marker([45.651872831999938, 8.947138857978208], {icon: ristoro_icon}).bindPopup("<img width=210 height=141 src=img/visconta.jpg><strong><br />Ristoro Visconta</strong>");
  var ristoro_smaria_lungo = L.marker([45.651081575394848, 8.968399155811024], {icon: ristoro_icon}).bindPopup("<img width=210 height=131 src=img/smaria.jpg /><strong><br />Ristoro S. Maria</strong>");
  var ristoro_massina_lungo = L.marker([45.6398993999927, 8.9654026], {icon: ristoro_icon}).bindPopup("<strong>Ristoro Massina</strong>");
  var ristoro_roccolo_lungo = L.marker([45.641661216226915, 8.953651498531297], {icon: ristoro_icon}).bindPopup("<img width=210 height=131 src=img/roccolo.jpg><strong><br />Risotoro il Roccolo</strong>");
  var ristoro_visconta_lungo = L.marker([45.651872831999938, 8.947138857978208], {icon: ristoro_icon}).bindPopup("<img width=210 height=141 src=img/visconta.jpg><strong><br />Ristoro Visconta</strong>");
  var stazione_cislago = L.marker([45.661008099999982, 8.9777585], {icon: stazione_icon}).bindPopup('Stazione di Cislago</br><a href="http://www.lenord.it">orario</a>').addTo(servizi);
  // Parcheggi
  // Dati GeoJSON
  var parcheggi = L.geoJson(parking, {
  pointToLayer : function (feature, latlng) {
  lat = feature.geometry.coordinates[0];
  lng = feature.geometry.coordinates[1];
  return L.marker([lng,lat],
  {icon: parcheggio_icon}) // NOTA: questa opzione non era presente prima
  .bindPopup("Parcheggio");
  }
  });
  parcheggi.addTo(servizi);
  <!--Added track from external geojson -->
  //track Style
  var cortostyle = {
  "color": "#BB2233",
  "weight": 4.5,
  "opacity": 0.6,
  "z-index": 2,
  };
  var mediostyle = {
  "color": "#4444BB",
  "weight": 4.5,
  "opacity": 0.6,
  "z-index": 2
  };
  var lungostyle = {
  "color": "#779900",
  "weight": 4.5,
  "opacity": 0.6,
  "z-index": 3
  };
  // track import
  var lungo = L.geoJson(lungo, {
  style: lungostyle
  }
  )
  .bindPopup('80% BOSCO');

  var medio = L.geoJson(medio, {
  style: mediostyle
  }
  );
  var corto = L.geoJson(corto, {
  style: cortostyle
  }
  )
  .bindPopup('Percorribile con passeggino');

  // Aggiungere DIV per weather ANCORA DA FARE
  var weather = L.control({position: 'bottomleft'});
  weather.onAdd = function (map) {
  this._div = L.DomUtil.create('div', 'weather'); // create a div with a class "weather"
  this.update();
  return this._div;
  };
  // method that we will use to update the control based on feature properties passed
  weather.update = function (props) {
  this._div.innerHTML = '<div id="placeholder"></div>';
  };
  $.getJSON('http://api.openweathermap.org/data/2.5/weather?lat=45.642&lon=8.954&units=metric&lang=IT', function(data) {
  // guarda il nome dell'icona
  console.log(data.weather[0].icon);
  // path relativo alla cartella con le icon
  immSource = 'img/icons/weather/night/'+data.weather[0].icon +'.png' ;
  $('#placeholder').html("<p><center><h5>OGGI:</h5><img src="+ immSource +" /> </br> <h6><strong>"+data.weather[0].description+"</h6></strong></center></p>");
  });
  weather.addTo(map);
  // Add layers control
  var corto_group = L.layerGroup([corto, ristoro_massina_corto]);
  var medio_group = L.layerGroup([medio, ristoro_massina_medio, ristoro_visconta_medio, ristoro_roccolo_medio]);
  var lungo_group = L.layerGroup([lungo, ristoro_massina_lungo, ristoro_visconta_lungo, ristoro_roccolo_lungo]);
  var groupedOverlays = {
  "<b>7 Km</b>": corto_group,
  "<b>15 Km</b>": medio_group,
  "<b>20 Km</b>": lungo_group
  };
  var groupedOverlays2 = {
  "come raggiungerci": servizi,
  };
  var options = { exclusiveGroups: ["Percorsi"] };
  L.control.layers(groupedOverlays, groupedOverlays2,{collapsed: false}).addTo(map);
  <!--Add scalebar -->
  L.control.scale({
  position: 'bottoleft',
  imperial: false
  }).addTo(map);



</script>
</body>
</html>
